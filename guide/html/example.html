<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <!-- <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> -->
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
  <!-- <link rel="icon" href="favicon.png"> -->
  <title>UI GUIDE</title>

  <!-- [S] PUBLISH STYLE -->
  <link rel="stylesheet" href="../css/style.css">
  <!-- [E] PUBLISH STYLE -->

  <!-- [S] LIBRARY - SCRIPT -->
  <script src="../lib/jquery/jquery-3.5.1.min.js"></script>
  <script src="../lib/jquery/jquery-ui-1.12.1.min.js"></script>
  <!-- [E] LIBRARY - SCRIPT -->
</head>
<body>
  <h1>Bingo</h1>
  <button type="button" class="start-btn">Start</button>
  <div class="bingo-wrap"></div>

  <!-- [S] STYLE -->
  <style>
    .bingo-btn {
      cursor: pointer;
      width: 20%;
      display: inline-flex;
      justify-content: center;
      padding: 20px 0;
      background: #fff;
      font-size: 20px;
      font-weight: bold;
      border: 1px solid #eee;
    }
    .bingo-btn + .bingo-btn {
      border-right: 0;
    }
    .bingo-btn:nth-child(5n) {
      border-right: 1px solid #eee;
    }
    .bingo-btn.active {
      background: #111;
      color: #fff;
    }
    .bingo-btn.complete {
      pointer-events: none;
      background: #666;
      color: #fff;
    }
  </style>
  <!-- [E] STYLE -->

  <!-- [S] SCRIPT -->
  <script>
    const startButton = document.querySelector(".start-btn");
    let bingoWrap = document.querySelector(".bingo-wrap");
    startButton.addEventListener("click", buttonCreate);
    let count = 0;

    function buttonCreate() {
      // 클릭할때 buttonwrap 초기화
      const options = {
        number: 50,
        count: 5,
        maximum: 3
      };
      let array = [];
      bingoWrap.innerHTML = "";

      // array length 가 25가 될때까지 반복
      while (array.length < Math.pow(options.count, 2)) {
        let num = Math.ceil(Math.random() * options.number); // 0~ 50 까지 숫자 생성
        // 배열에 중복값 없으면 push
        if (array.indexOf(num) == -1) {
          array.push(num);
        }
      }

      // 배열 길이만큼 버튼 생성(25개)
      for (let i = 0; i < array.length; i++) {
        let col = parseInt(i / options.count);
        let row = i % options.count;
        let btn = `<button type="button" class="bingo-btn" data-col=${col} data-row=${row} style="width:${100/options.count}%">${array[i]}</button>`;
        bingoWrap.innerHTML += btn;
      }

      const BingoBtn = document.querySelectorAll(".bingo-btn");

      BingoBtn.forEach((button) => {
        button.addEventListener("click", (e) => {
          if (count >= options.maximum) return;

          const buttonArray = Array.from(BingoBtn);

          e.target.dataset.active = true;
          e.target.classList.add("active");

          // 가로 필터
          const cols = buttonArray.filter(item => {
            return item.dataset.col == e.target.dataset.col && item.dataset.active;
          });
          // 가로 완성
          if (cols.length === options.count) {
            cols.forEach(item => item.classList.add("complete"));
            count++;
          }

          // 세로 필터
          const rows = buttonArray.filter(item => {
            return item.dataset.row == e.target.dataset.row && item.dataset.active;
          });
          // 세로 완성
          if (rows.length === options.count) {
            rows.forEach(item => item.classList.add("complete"));
            count++;
          }

          // 대각선A 필터
          const diagonalA = buttonArray.filter(item => {
            return item.dataset.col === item.dataset.row && item.dataset.active;
          });
          // 대각선A 완성
          if (e.target.dataset.col === e.target.dataset.row) {
            if (diagonalA.length === options.count) {
              diagonalA.forEach(item => item.classList.add("complete"));
              count++;
            }
          }

          // 대각선B 필터
          const diagonalB = buttonArray.filter(item => {
            return Number(item.dataset.col) + Number(item.dataset.row) === options.count - 1 && item.dataset.active;
          });
          // 대각선B 완성
          if (Number(e.target.dataset.col) + Number(e.target.dataset.row) === options.count - 1) {
            if (diagonalB.length === options.count) {
              diagonalB.forEach(item => item.classList.add("complete"));
              count++;
            }
          }
        });
      });
    }
  </script>
  <!-- [E] SCRIPT -->
</body>
</html>