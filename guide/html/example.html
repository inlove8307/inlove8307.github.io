<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <!-- <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> -->
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
  <!-- <link rel="icon" href="favicon.png"> -->
  <title>UI GUIDE</title>

  <!-- [S] PUBLISH STYLE -->
  <link rel="stylesheet" href="../css/style.css">
  <!-- [E] PUBLISH STYLE -->

  <!-- [S] LIBRARY - SCRIPT -->
  <script src="../lib/jquery/jquery-3.5.1.min.js"></script>
  <script src="../lib/jquery/jquery-ui-1.12.1.min.js"></script>
  <!-- [E] LIBRARY - SCRIPT -->
</head>
<body>
  <div class="container">
    <h1 class="bingo-title">BINGO</h1>
    <button type="button" class="bingo-start">START</button>
    <div class="bingo-wrap"></div>
  </div>

  <!-- [S] STYLE -->
  <style>
    .container {display: flex; flex-direction: column; align-items: center;}
    .bingo-title {padding: 1rem 0; font-size: 2.4rem;}
    .bingo-start {margin-bottom: 2rem; width: 7rem; height: 7rem; border-radius: 50%; box-shadow: inset 0 0 0 .1rem #666;}
    .bingo-wrap {display: flex; flex-flow: wrap; margin: -.5rem 0 0 -.5rem; width: 100%; max-width: 400px;}
    .bingo-button {margin: .5rem 0 0 .5rem; border-radius: .5rem; box-shadow: inset 0 0 0 .1rem #666; background: #fff; cursor: pointer;}
    .bingo-button.active {background: #222; color: #fff;}
    .bingo-button.complete {background: #666; color: #fff; pointer-events: none;}
  </style>
  <!-- [E] STYLE -->

  <!-- [S] SCRIPT -->
  <script>
    const start = document.querySelector(".bingo-start");
    const wrapper = document.querySelector(".bingo-wrap");
    const styles = document.defaultView.getComputedStyle(wrapper);

    const options = {
      number: 50,
      count: 5,
      maximum: 3
    };
    let count = 0;

    wrapper.style.height = styles.getPropertyValue('width');
    start.addEventListener("click", buttonCreate);

    function buttonCreate() {
      let array = [];
      count = 0;
      wrapper.innerHTML = "";

      while (array.length < Math.pow(options.count, 2)) {
        let num = Math.ceil(Math.random() * options.number);
        array.indexOf(num) === -1 && array.push(num);
      }

      for (let i = 0; i < array.length; i++) {
        wrapper.innerHTML += `<button type="button" class="bingo-button" data-col=${Math.floor(i / options.count)} data-row=${i % options.count} style="width:calc(${100 / options.count}% - 0.5rem)">${array[i]}</button>`;
      }

      const buttons = document.querySelectorAll(".bingo-button");

      buttons.forEach((button) => {
        button.addEventListener("click", (e) => {
          if (count >= options.maximum) return;

          const buttonArray = Array.from(buttons);
          let cols, rows, diagonalA, diagonalB;

          e.target.dataset.active = true;
          e.target.classList.add("active");

          cols = buttonArray.filter(item => item.dataset.col === e.target.dataset.col && item.dataset.active);
          if (cols.length === options.count) {
            cols.forEach(item => item.classList.add("complete"));
            count++;
          }

          rows = buttonArray.filter(item => item.dataset.row === e.target.dataset.row && item.dataset.active);
          if (rows.length === options.count) {
            rows.forEach(item => item.classList.add("complete"));
            count++;
          }

          diagonalA = buttonArray.filter(item => item.dataset.col === item.dataset.row && item.dataset.active);
          if (e.target.dataset.col === e.target.dataset.row) {
            if (diagonalA.length === options.count) {
              diagonalA.forEach(item => item.classList.add("complete"));
              count++;
            }
          }

          diagonalB = buttonArray.filter(item => Number(item.dataset.col) + Number(item.dataset.row) === options.count - 1 && item.dataset.active);
          if (Number(e.target.dataset.col) + Number(e.target.dataset.row) === options.count - 1) {
            if (diagonalB.length === options.count) {
              diagonalB.forEach(item => item.classList.add("complete"));
              count++;
            }
          }
        });
      });
    }
  </script>
  <!-- [E] SCRIPT -->
</body>
</html>